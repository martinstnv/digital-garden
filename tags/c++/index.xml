<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>C++ on Research Notes</title><link>/tags/c++/</link><description>Recent content in C++ on Research Notes</description><generator>Hugo</generator><language>en-us</language><copyright>Martin Stoynov</copyright><lastBuildDate>Sat, 10 Feb 2024 00:00:00 +0000</lastBuildDate><atom:link href="/tags/c++/index.xml" rel="self" type="application/rss+xml"/><item><title>Embedding Shellcode Code Caves</title><link>/notes/embedding-shellcode-in-code-caves/</link><pubDate>Sat, 10 Feb 2024 00:00:00 +0000</pubDate><guid>/notes/embedding-shellcode-in-code-caves/</guid><description>Theory Load malicious bytes into the “code cave” of a portable executable.
This doesn’t change the file size, because you will be replacing bytes that already exist with malicious code.
Typically, when a PE file executes, it follows the instructions from top to bottom. In contrary, when a trojan executes, it will immediately jump to the section containing the shellcode, execute the it and then return back the top of the file and run the program as usual.</description></item><item><title>Embedding Shellcode in Text, Data and Resource Sections</title><link>/notes/embedding-shellcode-in-text-data-and-resource-sections/</link><pubDate>Fri, 09 Feb 2024 00:00:00 +0000</pubDate><guid>/notes/embedding-shellcode-in-text-data-and-resource-sections/</guid><description>Text Section Write the shellcode and it’s length into variables.
#include &amp;lt;windows.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; #include &amp;lt;string.h&amp;gt; int main (VOID) { unsigned char shellcode_payload[196] = [ /* ... */ ]; unsigned int shellcode_length = 279; // ... } Allocate the memory space.
LPVOID memory_address = VirtualAlloc(NULL, shellcode_length, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE // [in, optional] LPVOID lpAddress, // [in] SIZE_T dwSize // [in] DWORD flAllocationType // [in] DWORD flProtect ); Load the shellcode into the allocated memory.</description></item><item><title>Compiling Code</title><link>/notes/compiling-code/</link><pubDate>Wed, 01 Nov 2023 00:00:00 +0000</pubDate><guid>/notes/compiling-code/</guid><description>Assignments Here is an example of a variable assignment:
int main() { int x; x = 3; } &amp;hellip; and here is the exact equivalent in assembler:
pushq %rbp movq %rsp, %rbp movl $3, -4(%rbp) movl $0, %eax popq %rbp ret It&amp;rsquo;s important to not that most of the instructions are responsible for starting and ending the main function, which determines where the program starts and ends.
This is the instruction that corresponds to the assignment of the x variable:</description></item></channel></rss>